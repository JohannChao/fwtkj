### 1，缓存雪崩

缓存雪崩是指在短时间内，大量缓存同时失效（过期或者Redis宕机），导致大量请求直接访问后端数据库,使数据库瞬间压力过大而崩溃的现象。

##### 缓存雪崩，解决方案
1. 均匀设置过期时间。设置过期时间时，给过期时间加上一个随机值，避免大量缓存同时过期；
2. 互斥锁(mutex key)方案。当业务线程在处理用户请求时，如果发现访问的数据不在 Redis 里，就加个互斥锁，保证同一时间内只有一个请求来构建缓存；
3. 后台更新缓存。业务线程不再负责更新缓存，缓存也不设置有效期，而是让缓存“永久有效”，并将更新缓存的工作交由后台线程定时更新。
4. Redis故障宕机引起的缓存雪崩，引入服务熔断或请求限流机制。
5. 构建 Redis 缓存高可靠集群

### 2，缓存击穿

缓存击穿是指对于某个热点key（例如秒杀活动），在缓存失效的瞬间，大量并发请求直接击穿缓存，直接请求数据库，导致数据库瞬间压力激增的现象。

##### 缓存击穿，解决方案
缓存击穿跟缓存雪崩很相似，可以认为缓存击穿是缓存雪崩的一个子集。

1. 互斥锁(mutex key)方案，保证同一时间只有一个业务线程获取锁并构建缓存，未能获取互斥锁的请求，要么等待锁释放后重新读取缓存，要么就返回空值或者默认值，这样可以避免大量并发请求同时访问数据库。
2. 不给热点数据设置过期时间，由后台异步更新缓存，或者在热点数据准备要过期前，提前通知后台线程更新缓存以及重新设置过期时间；
3. 资源隔离，为热点数据设置专门的缓存集群,避免影响其他业务。

### 3，缓存穿透

缓存穿透是指查询一个根本不存在的数据，缓存和数据库都没有相应的记录，没办法构建缓存数据，导致每次请求都要穿透缓存到数据库，给数据库造成较大压力的现象。

引起缓存穿透的主要原因有：
- 业务层误操作
- 恶意攻击

##### 缓存穿透，解决方案
1. 非法请求的限制，对请求参数进行合法性校验，过滤掉不合理的请求。
2. 缓存空对象，当数据库查询返回空结果时，在缓存中设置一个空值或者默认值，并设置一个较短的过期时间。
3. 采用布隆过滤器，在缓存失效查询数据库之前添加一层布隆过滤器（也可以在查询缓存之前就添加布隆过滤器），快速判断请求的 key 是否存在。如果布隆过滤器说不存在，那么一定不存在。