### 什么是IP地址
　　不管是学习网络还是上网，IP地址都是出现频率非常高的词。Windows系统中设置IP地址的界面，出现了IP地址、子网掩码、默认网关和DNS服务器这几个需要设置的地方，只有正确设置，网络才能通。
那这些名词都是什么意思呢?学习IP地址的相关知识时还会遇到网络地址、广播地址、子网等概念，这些又是什么意思呢？  

　　要回答这些问题，先看一个日常生活中的例子。住在北大街的住户要能互相找到对方，必须各自都要有个门牌号，这个门牌号就是各家的地址，门牌号的表示方法为：北大街+XX号。
假如1号住户要找6号住户，过程是这样的，1号在大街上喊了一声："谁是6号，请回答。"，这时北大街的住户都听到了，但只有6号作了回答，这个喊的过程叫"广播"，北大街的所有用户就是他的广播范围。
假如北大街共有20个用户，那广播地址就是：北大街 21号。也就是说，北大街的任何一个用户喊一声能让"广播地址-1"个用户听到。 

　　从这个例中可以抽出下面几个词：
```text
街道地址：北大街，如果给该大街一个地址则用第一个住户的地址-1表示，此例为：北大街0号

住户的号：如1号、2号等。

住户的地址：街道地址+XX号，如北大街 1号、北大街 2号等

广播地址：最后一个住户的地址+1，此例为：北大街21号
```


　　Internet网络中，每个上网的计算机都有一个像上述例子的地址，这个地址就是IP地址，是分配给网络设备的门牌号，为了网络中的计算机能够互相访问，
IP地址=网络地址+主机地址，假设一个IP地址为192.168.100.1，这个地址中包含了很多含义。如下所示：
```text
网络地址（相当于街道地址）： 192.168.100.0

主机地址（相当于各户的门号）： 0.0.0.1

IP地址（相当于住户地址）： 网络地址+主机地址=192.168.100.1【注：192.168.100.1是私有地址，不能直接在Internet网络中应用，上Internet要转为公有地址，详细说明见后文。】

广播地址： 192.168.100.255
```
    

### 如何计算网络地址
　　计算网络地址就是判断网络中的计算机是否在同一网络，在就能通，不在就不能通。注意，这里说的是否在同一网络指的是IP地址而不是物理连接。

　　要计算网络地址，必须借助我们上边提到过的子网掩码。具体的计算步骤为：将IP地址和子网掩码都换算成二进制，然后进行与运算（&），结果就是网络地址。
```text
计算IP地址为：202.99.160.50子网掩码是255.255.255.0的网络地址步骤如下：

1）将IP地址和子网掩码分别换算成二进制
202.99.160.50 换算成二进制为 11001010 01100011 10100000 00110010
255.255.255.0 换算成二进制为 11111111 11111111 11111111 00000000

2）将二者进行与运算
二者做与运算得到的结果为：11001010 01100011 10100000 00000000

3）将运算结果换算成十进制，这就是网络地址
11001010 01100011 10100000 00000000 换算成十进制就是 202.99.160.0
```

### IP地址表示法
　　IP地址 = 网络号+主机号

　　如果把整个Internet网作为一个单一的网络，IP地址就是给每个连在Internet网的主机分配一个全世界范围内唯一的标示符，Internet管理委员会定义了[A、B、C、D、E五类地址](pic/IP地址分类.png)，
在每类地址中，还规定了网络编号和主机编号。

　　在 TCP/IP协议中，IP地址是以二进制数字形式出现的，共32bit，1bit就是二进制中的1位，但这种形式非常不适用于人阅读和记忆。
因此Internet管理委员会决定采用一种"[点分十进制表示法](https://baike.baidu.com/item/%E7%82%B9%E5%88%86%E5%8D%81%E8%BF%9B%E5%88%B6)"表示IP地址：面向用户的文档中，32比特的二进制IP地址被直观地表示为四个以圆点隔开的十进制整数，
其中，每一个整数对应一个字节（8个比特为一个字节称为一段）。A、B、C类最常用，下面加以介绍。本文介绍的都是版本4的IP地址，称为IPv4.

#### A类地址
　　A类地址的网络标识由第一组8位二进制数表示， A类地址的特点是网络标识的第一位二进制数取值必须为"0"。不难算出，A类地址第一个地址为00000001，最后一个地址是01111111，换算成十进制就是127，其中127留作保留地址，
A类地址的第一段范围是：1～126。A类地址允许有2^7 -2=126个网段（网络标识共8位，其中前1位固定，剩余7位。减2是因为0不用，127留作它用），网络中的主机标识占3组8位二进制数，每个网络允许有2^24 -2=16777216台主机（减2是因为全0地址为网络地址，全1为广播地址，这两个地址一般不分配给主机）。

　　通常分配给拥有大量主机的网络。

#### B类地址
　　B类地址的网络标识由前两组8位二进制数表示，网络中的主机标识占两组8位二进制数，B类地址的特点是网络标识的前两位二进制数取值必须为"10"。B类地址第一段的第一个地址为10000000，最后一个地址是10111111，
换算成十进制B类地址第一段范围就是128～191，B类地址允许有2^14 =16384个网段（网络标识共16位，其中前2位固定，剩余14位），网络中的主机标识占2组8位二进制数，每个网络允许有2^16-2=65533台主机。

　　适用于结点比较多的网络。

#### C类地址
　　C类地址的网络标识由前3组8位二进制数表示，网络中主机标识占1组8位二进制数，C类地址的特点是网络标识的前3位二进制数取值必须为"110"。C类地址第一段的第一个地址为11000000，最后一个地址是11011111，
换算成十进制C类地址第一段范围就是192～223，C类地址允许有2^21 =2097152个网段（网络标识共24位，其中前3位固定，剩余21位），网络中的主机标识占1组8位二进制数，每个网络允许有2^8-2= 254台主机。

　　适用于结点比较少的网络。

#### D类地址
　　D类地址不分网络地址和主机地址，它的第1个字节的前四位固定为"1110"。D类地址用于多点播送，称为广播地址，供特殊协议向选定的节点发送信息时用。

#### E类地址
　　E类地址保留给将来使用，它的第1个字节的前五位固定为"11110"。

### 特殊的IP地址

#### 私有地址
　　上面提到IP地址在全世界范围内唯一，看到这句话你可能有这样的疑问，像 192.168.0.1 这样的地址在许多地方都能看到，并不唯一，这是为何？

　　Internet管理委员会规定如下地址段为私有地址，私有地址可以自己组网时用，但不能在Internet网上用，Internet网没有这些地址的路由，有这些地址的计算机要上网必须转换成为合法的IP地址,也称为公网地址。这就像有很多的世界公园，每个公园内都可命名相同的大街，如香榭丽舍大街，但对外我们只能看到公园的地址和真正的香榭丽舍大街。

　　下面是A、B、C类网络中的私有地址段。你自己组网时就可以用这些地址了。
```text
A类网络私有地址：10.0.0.0～10.255.255.255

B类网络私有地址：172.16.0.0～172.131.255.255

C类网络私有地址：192.168.0.0～192.168.255.255
```

#### 回送地址
　　A类网络地址127是一个保留地址，用于网络软件测试以及本地机进程间通信，叫做回送地址（loopback address）。无论什么程序，一旦使用回送地址发送数据，协议软件立即返回之，不进行任何网络传输。含网络号127的分组不能出现在任何网络上。

#### 广播地址
　　TCP/IP规定，主机号全为"1"的网络地址用于广播之用，叫做广播地址。所谓广播，指同时向同一子网所有主机发送报文。

#### 网络地址
　　TCP/IP协议规定，各位全为"0"的网络号被解释成"本"网络。

#### 总结
由上可以看出：
1. 含网络号127的分组不能出现在任何网络上；
2. 主机和网关不能为该地址广播任何寻径信息。由以上规定可以看出，主机号全"0"，全"1"的地址在TCP/IP协议中有特殊含义，一般不能用作一台主机的有效地址。

### 子网掩码
　　从上面的例子可以看出，子网掩码的作用就是和IP地址“与运算”后得出网络地址，子网掩码也是32bit，并且是一串1后跟随一串0组成，其中1表示在IP地址中的网络号对应的位数，而0表示在IP地址中主机对应的位数。

　　子网掩码确定网络号的位数

　　掩码（英语：Mask）：在计算机学科及数字逻辑中指的是一串二进制数字，通过与目标数字的按位操作，达到屏蔽指定位而实现需求。

#### 标准子网掩码
* A类网络（1 - 126） 缺省子网掩码：255·0·0·0。

　　换算成二进制为 11111111·00000000·00000000·00000000

　　可以清楚地看出前8位是网络地址，后24位是主机地址，也就是说，如果用的是标准子网掩码，看第一段地址即可看出是不是同一网络的。如21.0.0.0.1和21.240.230.1，第一段为21属于A类，如果用的是默认的子网掩码，那这两个地址就是一个网段的。

* B类网络（128 - 191） 缺省子网掩码：255·255·0·0

* C类网络（192 - 223） 缺省子网掩码：255·255·255·0

　　如果用的是标准子网掩码，B类网络看前2字节，C类网络看前3字节，即可知道是否在同一个网段。
#### 特殊的子网掩码
　　标准子网掩码出现的都是255和0的组合，在实际的应用中还有其他的子网掩码，如255·255·192·0，255·255·255·248等，这些子网掩码的出现是为了把一个网络划分成多个网络。 

### 网络地址，广播地址，地址范围，主机数量
* 子网掩码中连续全是1的前 n 位，对应的是网络地址，剩下的 32-n 位是主机地址。

* 将IP地址和子网掩码换算为二进制，进行与操作，得到的就是网络地址，网络地址的主机号全为"0"。

* 主机号全为"1"的网络地址，叫做广播地址。

* 地址范围就是含在本网段内的所有主机。 网络地址+1即为第一个主机地址，广播地址-1即为最后一个主机地址，由此得出地址范围是： 网络地址+1 至 广播地址-1。

* 主机的数量 = 2^(主机号对应的二进制位数，即32-n) - 2，减2是因为主机不包括网络地址和广播地址。


### 划分子网
　　上面的例子192.168.0.0 子网掩码为255.255.255.0的这个网络中可容纳254台主机，如果想把一个网络分成两个以上的网络该如何分呢？
IP地址是由网络地址+主机地址组成的，增加网络部分的长度，减少主机地址的长度就能将一个网络划分成数个网络。具体的解决办法就是增加子网掩码中连续1，这样相应的主机地址就减少了

```text
以IP为 192.168.0.0 ，子网掩码为 255.255.255.0 举例

1，示例1
网络地址是 192.168.0.0 ，广播地址是 192.168.0.255
IP  : 11000000·101010000·00000000·00000000
Mask: 11111111·111111111·11111111·00000000
网络地址192.168.0.0 :11000000·101010000·00000000·00000000
广播地址192.168.0.63:11000000·101010000·00000000·11111111
当子网掩码为 255.255.255.0 时，此时网络号是24位，主机号是8位，即主机数量为 2^8-2=254台主机，这些主机在同一个网络下，网络地址都是 192.168.0.0

2，示例2
子网掩码向主机号借两位，变成26位 255.255.255.192（11111111·111111111·11111111·11000000）
IP  : 11000000·101010000·00000000·00000000
Mask: 11111111·111111111·11111111·11000000
此时，网络号是26位，主机号是6位，原本的地址范围 192.168.0.0 --- 192.168.0.255 被分成了4个网络地址，即分成个4个子网

    case1: 地址范围 192.168.0.0 --- 192.168.0.63，网络地址是 192.168.0.0 ，广播地址是 192.168.0.63
    IP  : 11000000·101010000·00000000·00000000
    IP  : 11000000·101010000·00000000·00111111
    Mask: 11111111·111111111·11111111·11000000
    网络地址192.168.0.0 :11000000·101010000·00000000·00000000
    广播地址192.168.0.63:11000000·101010000·00000000·00111111

    case2: 地址范围 192.168.0.64 --- 192.168.0.127，网络地址是 192.168.0.64 ，广播地址是 192.168.0.127
    IP  : 11000000·101010000·00000000·01000000
    IP  : 11000000·101010000·00000000·01111111
    Mask: 11111111·111111111·11111111·11000000
    网络地址192.168.0.64 :11000000·101010000·00000000·01000000
    广播地址192.168.0.127:11000000·101010000·00000000·01111111
    
    case3: 地址范围 192.168.0.128 --- 192.168.0.191，网络地址是 192.168.0.128 ，广播地址是 192.168.0.191
    IP  : 11000000·101010000·00000000·10000000
    IP  : 11000000·101010000·00000000·10111111
    Mask: 11111111·111111111·11111111·11000000
    网络地址192.168.0.128:11000000·101010000·00000000·10000000
    广播地址192.168.0.191:11000000·101010000·00000000·10111111
    
    case4: 地址范围 192.168.0.192 --- 192.168.0.255，网络地址是 192.168.0.192 ，广播地址是 192.168.0.255
    IP  : 11000000·101010000·00000000·11000000
    IP  : 11000000·101010000·00000000·11111111
    Mask: 11111111·111111111·11111111·11000000
    网络地址192.168.0.192:11000000·101010000·00000000·11000000
    广播地址192.168.0.255:11000000·101010000·00000000·11111111

以上示例可以看出，子网掩码向主机号借两位后，当前IP 192.168.0.0 被分成了四个自网络，地址分别为
192.168.0.0  :11000000·101010000·00000000·00000000
192.168.0.64 :11000000·101010000·00000000·01000000
192.168.0.192:11000000·101010000·00000000·10000000
192.168.0.255:11000000·101010000·00000000·11000000
每个子网的主机个数分别是 2^6-2=62 个

3，结论
1）划分子网的时候，子网掩码需要向主机号借位，划分的子网个数 = 2^(向主机号借的位数)
2）如果所在网络中不允许使用全0和全1的网络，那case1和4因为分别是全0和全1组合，不能使用，该网络只能分为case2、case3两个子网。
此时，划分的子网个数 = 2^(向主机号借的位数)-2
即：借两位，得到2^2 - 2 = 2个子网；借三位，得到2^3 - 2 = 6个子网；借四位，得到2^4 - 2 = 14个子网；
```

#### 为什么不使用全0和全1子网
　　上面提到一般不使用全0和全1子网，为什么呢？

　　上例中IP192·168·0·0，掩码255.255.255.192 可分成4个子网，第一个子网192.168.0.1 - 192.168.0.62和最后一个子网192.168.0.193 - 192.168.0.254通常也被保留,不能使用。
原因是,第一个子网的网络地址192.168.0.0和最后一个子网的广播地址192.168. 0.255具有二意性。

　　先看这个大的C类网络地址和广播地址，192.168.0.0是它的网络地址,192.168.0.255是它的广播地址。显然,它们分别与第一个子网的网络地址和最后一个子网的广播地址相重了。

　　那么怎样区分192.168.0.0到底是哪个网络的网络地址呢? 答案是:把子网掩码加上去。
```text
192.168.0.0    255.255.255.0    中192.168.0.0是大C类网络的网络地址。

192.168.0.0    255.255.255.192  中192.168.0.0 是第一个子网的网络地址。

192.168.0.255  255.255.255.0    中192.168.0.255是大C类网络的广播地址。

192.168.0.255  255.255.255.192  中192.168.0.255是最后一个子网的广播地址。
```
　　带上掩码,它们的二意性就不存在了。

　　所以,在严格按照TCP/IP  A B C D给IP地址分类的环境下,为了避免二意性，全0和全1网段都不让使用，这种环境我们叫作Classful（有类网络）。在这种环境下，子网掩码只在所定义的路由器内有效，掩码信息到不了其它路由器。
比如RIP-1，它在做路由广播时根本不带掩码信息，收到路由广播的路由器因为无从知道这个网络的掩码，只好照标准TCP/IP的定义赋予它一个掩码。
比如,拿到10.X.X.X，就认为它是A类，掩码是255.0.0.0；拿到一个204.X.X.X，就认为它是C类，掩码是255.255.255.0。但在Classless（无类网络）的环境下,掩码任何时候都和IP地址成对地出现,这样,前面谈到的二意性就不会存在。

　　是Classful还是Classless取决于你在路由器上运行的路由协议，一个路由器上可同时运行Classful和Classless的路由协议。
RIP1是Classful的，它在做路由广播时不带掩码信息；OSPF,EIGRP,BGP4是Classless的，它们在做路由广播时带掩码信息，它们可以同时运行在同一台路由器上。
在CISCO路由器上，缺省你可以使用全1网段，但不能使用全0网段。所以，当你在CISCO路由器上给端口定义IP地址时，该IP地址不能落在全0网段上。如果你配了，你会得到一条错误信息。
使用IP SUBNET-ZERO命令之后，你才能使用全0网段。另外要强调的是，使用了IP SUBNET-ZERO命令之后,如果路由协议使用的是CLASSFUL的(如RIP1),虽然你定义成功了，
但那个子网掩码还是不会被RIP1带到它的路由更新报文中。即IP SUBNET-ZERO 命令不会左右路由协议的工作。

　　总之,TCP/IP协议中,全0和全1网段因为具有二意性而不能被使用。CISCO缺省使全1网段可以被使用，但全0网段只有在配置了IP SUBNET-ZERO后方可被使用。
> Rip1与Rip2的 区别
> * RIP1是有类路由(classful)协议，它们在宣告路由信息时不携带网络掩码
> * RIP2是无类路由(classless)协议，它们在宣告路由信息时携带网络掩码
> * RIP1是广播发送路由更新，广播地址为255.255.255.255
> * RIP2是组播发送路由更新，广播地址为224.0.0.9

### CIDR（无类型域间路由，Classless Inter-Domain Routing）
[CIDR无类型域间路由](网络编程_IP地址_CIDR无类型间域路由.md)





### 参考
[IP地址](https://www.cnblogs.com/duanwandao/p/9922909.html#_label8)